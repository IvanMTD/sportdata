<div class="container-fluid">
    <div class="row">
        <div class="col">
            <div class="container border border-2 border-dark rounded-4">
                <div class="row bg-dark text-center rounded-top-3">
                    <h1>
                        <small class="text-white">
                            Зарегистрировать соревнование
                        </small>
                    </h1>
                </div>
                <form class="row" th:method="POST" th:action="@{/contest/add}" th:object="${contestForm}">
                    <div class="row">
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white" style="width: 100px">ЕКП</span>
                                <input type="text" class="form-control" placeholder="Укажите ЕКП" th:field="*{ekp}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white"
                                      style="width: 100px">Название</span>
                                <input type="text" class="form-control" placeholder="Название мероприятия"
                                       th:field="*{title}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white" style="width: 100px">Вид спорта</span>
                                <select id="sport-id-data" type="text" class="form-select" th:field="*{sportId}">
                                    <option th:each="sport, sp : ${sports}" th:data-index="${sp.index}" th:text="${sport.getTitle()}" th:value="${sport.getId()}"></option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('ekp')}" th:errors="*{ekp}"></small>
                        </div>
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('title')}"
                                   th:errors="*{title}"></small>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white"
                                      style="width: 100px">Начало</span>
                                <input type="date" class="form-control" th:field="*{beginning}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white" style="width: 100px">Конец</span>
                                <input type="date" class="form-control" th:field="*{ending}">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('beginning')}" th:errors="*{beginning}"></small>
                        </div>
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('ending')}" th:errors="*{ending}"></small>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white"
                                      style="width: 100px">Субъект</span>
                                <select class="form-select" th:field="*{subjectId}">
                                    <option th:each="subject : ${subjects}" th:text="${subject.getTitle()}"
                                            th:value="${subject.getId()}"></option>
                                </select>
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white" style="width: 100px">Город</span>
                                <input type="text" class="form-control" placeholder="Город проведения"
                                       th:field="*{city}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white"
                                      style="width: 100px">Объект</span>
                                <input type="text" class="form-control" placeholder="Спортивный объект"
                                       th:field="*{location}">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col"></div>
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('city')}" th:errors="*{city}"></small>
                        </div>
                        <div class="col">
                            <small class="text-danger" th:if="${#fields.hasErrors('location')}" th:errors="*{location}"></small>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-grid py-2">
                                <button id="total-subjects-button" type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#subjects-modal" onclick="rename()">
                                    Субъекты принявшие участие
                                </button>
                                <script>
                                    function rename() {
                                        $('#total-subjects-button').empty();
                                        $('#total-subjects-button').text('Субъекты - нажмите для редактирования');
                                    }
                                </script>
                                <div class="modal fade" id="subjects-modal" tabindex="-1"
                                     aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="exampleModalLabel">Укажите
                                                    субъекты</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">
                                                <div class="container">
                                                    <div class="row">
                                                        <div id="col-1" class="col"></div>
                                                        <div id="col-2" class="col"></div>
                                                        <script th:inline="javascript">
                                                            let sl = [[${subjects}]];
                                                            let c1 = $('#col-1');
                                                            let c2 = $('#col-2');
                                                            let d = sl.length / 2;
                                                            for(let i=0; i<sl.length; i++){
                                                                if(i <= d){
                                                                    c1.append(
                                                                        '<div class="form-check">\n' +
                                                                        '   <input class="form-check-input" type="checkbox" name="totalSubjects[' + i + ']" value="' + sl[i].id + '">\n' +
                                                                        '   <label class="form-check-label" th:text="${subject.getTitle()}">' + sl[i].title + '</label>\n' +
                                                                        '</div>'
                                                                    );
                                                                }else{
                                                                    c2.append(
                                                                        '<div class="form-check">\n' +
                                                                        '   <input class="form-check-input" type="checkbox" name="totalSubjects[' + i + ']" value="' + sl[i].id + '">\n' +
                                                                        '   <label class="form-check-label" th:text="${subject.getTitle()}">' + sl[i].title + '</label>\n' +
                                                                        '</div>'
                                                                    );
                                                                }
                                                            }
                                                        </script>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
                                                    Вернуться
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white">Всего участников</span>
                                <input type="number" class="form-control" placeholder="Укажите количество"
                                       th:field="*{participantTotal}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white">М</span>
                                <input type="number" class="form-control" placeholder="Укажите количество"
                                       th:field="*{boyTotal}">
                            </div>
                        </div>
                        <div class="col">
                            <div class="input-group py-2">
                                <span class="input-group-text bg-secondary text-white">Ж</span>
                                <input type="number" class="form-control" placeholder="Укажите количество"
                                       th:field="*{girlTotal}">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <hr>
                        <p class="text-center fs-5">Общая оценка квалификаций спортсменов принявших участие в
                            соревновании, всего из них:</p>
                    </div>
                    <div class="row">
                        <div class="row">
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">БР</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{br}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Ю1</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{yn1}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Ю2</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{yn2}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Ю3</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{yn3}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Р1</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{r1}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Р2</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{r2}">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">Р3</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{r3}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">КМС</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{kms}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">МС</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{ms}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">МСМК</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{msmk}">
                                </div>
                            </div>
                            <div class="col">
                                <div class="input-group py-2">
                                    <span class="input-group-text bg-secondary text-white">ЗМС</span>
                                    <input type="number" class="form-control" placeholder="Укажите количество"
                                           th:field="*{zms}">
                                </div>
                            </div>
                        </div>
                        <hr>
                    </div>
                    <div id="script_container" style="padding-right: 37px">

                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="d-grid py-2">
                                <button class="btn btn-dark" type="button" onclick="addSportForm()">
                                    Добавить дисциплину
                                </button>
                                <script th:inline="javascript">
                                    let count = 0;
                                    let pCount = 0;
                                    let categories = [[${categories}]];
                                    let standards = [[${federalStandards}]];
                                    let conditions = [[${conditions}]];

                                    function addSportForm() {
                                        let sportId = document.getElementById('sport-id-data').value;

                                        $.ajax({
                                            url: '/rest/database/get/sport',
                                            type: 'get',
                                            data: {
                                                query: sportId
                                            },
                                            success: function (sport) {
                                                $('#script_container').append(
                                                    '<div id="container-' + count + '">' +
                                                    '   <hr>' +
                                                    '   <div class="row">' +
                                                    '       <div class="row">' +
                                                    '           <div class="col">' +
                                                    '               <div class="row">' +
                                                    '                   <div class="col">' +
                                                    '                       <div class="input-group py-2">' +
                                                    '                           <span class="input-group-text bg-secondary text-white" style="width: 100px">Дисциплина</span>' +
                                                    '                           <select name="sports[' + count + '].disciplineId" id="discipline-' + count + '-select" class="form-select"></select>' +
                                                    '                       </div>' +
                                                    '                   </div>' +
                                                    '                   <div class="col">' +
                                                    '                       <div class="input-group py-2">' +
                                                    '                           <span class="input-group-text bg-secondary text-white">Возростная группа</span>' +
                                                    '                           <select name="sports[' + count + '].groupId" id="group-' + count + '-select" class="form-select"></select>' +
                                                    '                       </div>' +
                                                    '                   </div>' +
                                                    '               </div>' +
                                                    '               <div class="row">' +
                                                    '                   <div class="col">' +
                                                    '                       <div class="d-grid py-2">\n' +
                                                    '                           <button id="total-subjects-button" type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#category-modal-' + count + '">\n' +
                                                    '                               Допуски\n' +
                                                    '                           </button>\n' +
                                                    '                           <div class="modal fade" id="category-modal-' + count + '" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">\n' +
                                                    '                               <div class="modal-dialog">\n' +
                                                    '                                   <div class="modal-content">\n' +
                                                    '                                       <div class="modal-header">\n' +
                                                    '                                           <h1 class="modal-title fs-5" id="exampleModalLabel">Укажите допуски</h1>\n' +
                                                    '                                           <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n' +
                                                    '                                       </div>\n' +
                                                    '                                       <div class="modal-body">\n' +
                                                    '                                           <div class="row">\n' +
                                                    '                                               <div class="col" id="categories-' + count + '">\n' +
                                                    '                                               </div>\n' +
                                                    '                                           </div>\n' +
                                                    '                                       </div>\n' +
                                                    '                                       <div class="modal-footer">\n' +
                                                    '                                           <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Вернуться</button>\n' +
                                                    '                                       </div>\n' +
                                                    '                                   </div>\n' +
                                                    '                               </div>\n' +
                                                    '                           </div>\n' +
                                                    '                       </div>' +
                                                    '                   </div>' +
                                                    '                   <div class="col">' +
                                                    '                       <div class="d-grid py-2">\n' +
                                                    '                           <button id="total-subjects-button" type="button" class="btn btn-dark" data-bs-toggle="modal" data-bs-target="#category-modal-2-' + count + '">\n' +
                                                    '                               Укажите ФССП\n' +
                                                    '                           </button>\n' +
                                                    '                           <div class="modal fade" id="category-modal-2-' + count + '" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">\n' +
                                                    '                               <div class="modal-dialog">\n' +
                                                    '                                   <div class="modal-content">\n' +
                                                    '                                       <div class="modal-header">\n' +
                                                    '                                           <h1 class="modal-title fs-5" id="exampleModalLabel">Укажите ФССП</h1>\n' +
                                                    '                                           <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n' +
                                                    '                                       </div>\n' +
                                                    '                                       <div class="modal-body">\n' +
                                                    '                                           <div class="row">\n' +
                                                    '                                               <div class="col" id="fssp-' + count + '">\n' +
                                                    '                                               </div>\n' +
                                                    '                                           </div>\n' +
                                                    '                                       </div>\n' +
                                                    '                                       <div class="modal-footer">\n' +
                                                    '                                           <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Вернуться</button>\n' +
                                                    '                                       </div>\n' +
                                                    '                                   </div>\n' +
                                                    '                               </div>\n' +
                                                    '                           </div>\n' +
                                                    '                       </div>' +
                                                    '                   </div>' +
                                                    '               </div>' +
                                                    '           </div>' +
                                                    '           <div class="col-1">' +
                                                    '               <div class="container d-flex justify-content-center align-items-center" style="height: 100%">' +
                                                    '                   <button id="del-' + count + '" type="button" class="btn-close mx-auto text-center border" aria-label="Close" onclick="deleteSport(this.id)"></button>' +
                                                    '               </div>' +
                                                    '           </div>' +
                                                    '       </div>' +
                                                    '   </div>' +
                                                    '   <div id="participant-div-' + count + '" style="padding-right: 25px"></div>' +
                                                    '   <div class="row">' +
                                                    '      <div class="d-grid py-2">\n' +
                                                    '           <button id="add-button-' + count + '" class="btn btn-dark" type="button" onclick="addParticipantForm(this.id)">Добавить финалиста</button>' +
                                                    '      </div>' +
                                                    '   </div>' +
                                                    '   <hr>' +
                                                    '</div>'
                                                );
                                                sport.disciplines.forEach(function (discipline) {
                                                    $('#discipline-' + count + '-select').append(
                                                        '<option value="' + discipline.id + '">' + discipline.title + '</option>'
                                                    );
                                                });
                                                sport.groups.forEach(function (group) {
                                                    $('#group-' + count + '-select').append(
                                                        '<option value="' + group.id + '">' + group.title + ' | ' + group.minAge + '-' + group.maxAge + '</option>'
                                                    );
                                                });

                                                let f = 0;
                                                standards.forEach(function (standard){
                                                    $('#fssp-' + count).append(
                                                        '   <div class="form-check">' +
                                                        '       <input name="sports[' + count + '].standards[' + f + ']" value="' + standard.federalStandard + '" class="form-check-input" type="checkbox"">' +
                                                        '       <label class="form-check-label">' + standard.title + '</label>' +
                                                        '   </div>'
                                                    );
                                                    f++;
                                                });

                                                let c = 0;
                                                categories.forEach(function (category){
                                                    $('#categories-' + count).append(
                                                        '<div class="col">' +
                                                        '   <div class="form-check">' +
                                                        '       <input name="sports[' + count + '].allowed[' + c + ']" value="' + category.category + '" class="form-check-input" type="checkbox"">' +
                                                        '       <label class="form-check-label">' + category.title + '</label>' +
                                                        '   </div>' +
                                                        '</div>'
                                                    );
                                                    c++;
                                                });
                                            }
                                        });
                                        count++;
                                    }

                                    function addParticipantForm(buttonId) {
                                        let parts = buttonId.split('-');
                                        let index = parseInt(parts[parts.length - 1]);

                                        let searchQuery = document.getElementById('sport-id-data').value;

                                        $.ajax({
                                            url: '/rest/database/sport/participants',
                                            type: 'get',
                                            data: {
                                                query: searchQuery
                                            },
                                            success: function (participants) {
                                                let participantContainer = $('#participant-div-' + index);
                                                participantContainer.append(
                                                    '<div id="container-' + index + '-' + pCount + '">' +
                                                    '<hr>' +
                                                    '<div class="row">' +
                                                    '   <div class="col">' +
                                                    '       <div class="row">' +
                                                    '          <div class="col">' +
                                                    '              <div class="input-group py-2">' +
                                                    '                  <span class="input-group-text bg-secondary text-white" style="width: 100px">Спортсмен</span>' +
                                                    '                  <select name="sports[' + index + '].places[' + pCount + '].participantId" id="participant-' + pCount + '" class="form-select" onchange="rebuildCategory(this.id)"></select>' +
                                                    '              </div>' +
                                                    '          </div>' +
                                                    '          <div class="col">' +
                                                    '              <div class="input-group py-2">' +
                                                    '                  <span class="input-group-text bg-secondary text-white" style="width: 100px">Организация</span>' +
                                                    '                  <select name="sports[' + index + '].places[' + pCount + '].schoolId" id="school-' + pCount + '" class="form-select"></select>' +
                                                    '              </div>' +
                                                    '          </div>' +
                                                    '       </div>' +
                                                    '       <div class="row">' +
                                                    '          <div class="col">' +
                                                    '              <div class="input-group py-2">' +
                                                    '                  <span class="input-group-text bg-secondary text-white" style="width: 100px">Разряд</span>' +
                                                    '                  <select name="sports[' + index + '].places[' + pCount + '].qualificationId" id="qualification-' + pCount + '" class="form-select"></select>' +
                                                    '              </div>' +
                                                    '          </div>' +
                                                    '          <div class="col">' +
                                                    '               <div class="input-group py-2">' +
                                            '                           <span class="input-group-text bg-secondary text-white">Занял место</span>' +
                                            '                           <select name="sports[' + index + '].places[' + pCount + '].place" id="qualification-' + pCount + '" class="form-select">' +
                                            '                               <option value="1" selected>1</option>' +
                                            '                               <option value="2">2</option>' +
                                            '                               <option value="3">3</option>' +
                                            '                           </select>' +
                                            '                       </div>' +
                                            '                   </div>' +
                                            '                   <div class="col">' +
                                            '                       <div class="input-group py-2">' +
                                            '                           <span class="input-group-text bg-secondary text-white">ЕВСК</span>' +
                                            '                           <select name="sports[' + index + '].places[' + pCount + '].condition" id="condition-' + pCount + '" class="form-select">' +
                                            '                           </select>' +
                                            '                       </div>' +
                                            '                   </div>' +
                                            '                   <div class="col">' +
                                            '                       <div class="input-group py-2">' +
                                            '                           <span class="input-group-text bg-secondary text-white">Состояние</span>' +
                                            '                           <select name="sports[' + index + '].places[' + pCount + '].newQualificationData" id="nq-' + pCount + '" class="form-select">' +
                                            '                           </select>' +
                                                    '               </div>' +
                                                    '           </div>' +
                                                    '       </div>' +
                                                    '   </div>' +
                                                    '   <div class="col-1">' +
                                                    '       <div class="container d-flex justify-content-center align-items-center" style="height: 100%">' +
                                                    '           <button id="del-' + index + '-' + pCount + '" type="button" class="btn-close mx-auto text-center border" aria-label="Close" onclick="deleteParticipant(this.id)"></button>' +
                                                    '       </div>' +
                                                    '   </div>' +
                                                    '</div>' +
                                                    '<hr>' +
                                                    '</div>'
                                                );

                                                categories.forEach(function (category){
                                                    $('#nq-' + pCount).append(
                                                        '<option value="' + category.category + '">' + category.title + '</option>'
                                                    );
                                                });

                                                conditions.forEach(function (condition){
                                                    $('#condition-' + pCount).append(
                                                        '<option value="' + condition.condition + '">' + condition.title + '</option>'
                                                    );
                                                });

                                                participants.forEach(function (participant) {
                                                    $('#participant-' + pCount).append(
                                                        '<option data-item="' + JSON.stringify(participant).replace(/"/g, '&quot;') + '" value="' + participant.id + '">' + participant.fullName + ' | Год рождения: ' + participant.date + ' | Возраст: ' + participant.age + '</option>'
                                                    );
                                                });

                                                participants[0].qualifications.forEach(function (qualification) {
                                                    $('#qualification-' + pCount).append(
                                                        '<option value="' + qualification.id + '">' + qualification.categoryTitle + ' - ' + qualification.sport.title + '</option>'
                                                    );
                                                });

                                                participants[0].schools.forEach(function (school) {
                                                    $('#school-' + pCount).append(
                                                        '<option value="' + school.id + '">' + school.subject.title + ' - ' + school.title + '</option>'
                                                    );
                                                });
                                            }
                                        });
                                        pCount++;
                                    }

                                    function rebuildCategory(selectId) {
                                        let parts = selectId.split('-');
                                        let index = parseInt(parts[parts.length - 1]);
                                        let select = document.getElementById(selectId);
                                        let option = select.options[select.selectedIndex];
                                        let participant = JSON.parse(option.getAttribute('data-item').replace(/&quot;/g, '"'));
                                        let qualifications = participant.qualifications;
                                        let schools = participant.schools;
                                        $('#qualification-' + index).empty();
                                        qualifications.forEach(function (qualification) {
                                            $('#qualification-' + index).append(
                                                '<option value="' + qualification.id + '">' + qualification.categoryTitle + ' - ' + qualification.sport.title + '</option>'
                                            );
                                        });
                                        $('#school-' + index).empty();
                                        schools.forEach(function (school) {
                                            $('#school-' + index).append(
                                                '<option value="' + school.id + '">' + school.subject.title + ' - ' + school.title + '</option>'
                                            );
                                        });
                                    }

                                    function deleteSport(delId) {
                                        let parts = delId.split('-');
                                        let index = parseInt(parts[parts.length - 1]);
                                        let container = $('#container-' + index);
                                        container.empty();
                                    }

                                    function deleteParticipant(delId2) {
                                        let parts = delId2.split('-');
                                        let index2 = parseInt(parts[parts.length - 1]);
                                        let index1 = parseInt(parts[parts.length - 2]);
                                        console.log(index1 + ' ' + index2)
                                        let container = $('#container-' + index1 + '-' + index2);
                                        container.empty();
                                    }
                                </script>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <hr>
                        <div class="row">
                            <p class="text-center fs-5">Итоги соревнование по субъектам</p>
                        </div>
                        <div class="row mx-auto">
                            <div class="col">
                                <div class="row" style="background-color: gold">
                                    <div class="container d-flex justify-content-center align-items-center" style="height: 50px">
                                        <div class="mx-auto text-center fs-5 px-2 rounded-circle">
                                            <span class="text-center fs-5">1 место</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col" id="col-first-place">
                                        <div class="row">
                                            <div class="col-8">
                                                <div class="input-group py-2">
                                                    <span class="input-group-text bg-secondary text-white">Субъект</span>
                                                    <select id="select-first-place" class="form-select">
                                                        <option th:each="subject : ${subjects}" th:text="${subject.getTitle()}" th:value="${subject.getId()}"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="d-grid py-2">
                                                    <button class="btn btn-dark" type="button" onclick="addFirstPlace()">Добавить</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row" style="background-color: silver">
                                    <div class="container d-flex justify-content-center align-items-center" style="height: 50px">
                                        <div class="mx-auto text-center fs-5 px-2 rounded-circle">
                                            <span class="text-center fs-5">2 место</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col" id="col-second-place">
                                        <div class="row">
                                            <div class="col-8">
                                                <div class="input-group py-2">
                                                    <span class="input-group-text bg-secondary text-white">Субъект</span>
                                                    <select id="select-second-place" class="form-select">
                                                        <option th:each="subject : ${subjects}" th:text="${subject.getTitle()}" th:value="${subject.getId()}"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="d-grid py-2">
                                                    <button class="btn btn-dark" type="button" onclick="addSecondPlace()">Добавить</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col">
                                <div class="row" style="background-color: darkgoldenrod">
                                    <div class="container d-flex justify-content-center align-items-center" style="height: 50px">
                                        <div class="mx-auto text-center fs-5 px-2 rounded-circle">
                                            <span class="text-center fs-5">3 место</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col" id="col-last-place">
                                        <div class="row">
                                            <div class="col-8">
                                                <div class="input-group py-2">
                                                    <span class="input-group-text bg-secondary text-white">Субъект</span>
                                                    <select id="select-last-place" class="form-select">
                                                        <option th:each="subject : ${subjects}" th:text="${subject.getTitle()}" th:value="${subject.getId()}"></option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="col-4">
                                                <div class="d-grid py-2">
                                                    <button class="btn btn-dark" type="button" onclick="addLastPlace()">Добавить</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <script th:inline="javascript">
                                let subjects = [[${subjects}]];
                                let fCount = 0;
                                let sCount = 0;
                                let lCount = 0;
                                function addFirstPlace(){
                                    let id = document.getElementById('select-first-place').value;
                                    let subject;
                                    for(let i=0; i<subjects.length; i++){
                                        if(subjects[i].id == id){
                                            subject = subjects[i];
                                        }
                                    }
                                    $('#col-first-place').append(
                                        '<div class="row" id="f-r-' + fCount + '">' +
                                        '   <div class="col">' +
                                        '       <div class="input-group py-2">\n' +
                                        '           <span class="input-group-text bg-secondary text-white">Субъект</span>\n' +
                                        '           <input class="form-control" type="text" value="' + subject.title + '" disabled>' +
                                        '           <input name="firstPlace[' + fCount +'participant-' + ${as_stat_index} + '-' + ${p_stat.index} ']" class="form-control" type="number" value="' + subject.id + '" hidden>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '   <div class="col-1">' +
                                        '       <div class="container d-flex justify-content-center align-items-center" style="height: 100%">' +
                                        '           <button id="f-del-' + fCount + '" type="button" class="btn-close mx-auto text-center border" aria-label="Close" onclick="fDel(this.id)"></button>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '</div>'
                                    );

                                    fCount++;
                                    if(fCount >= 10){
                                        fCount = 0;
                                    }
                                }

                                function fDel(id) {
                                    let parts = id.split('-');
                                    let index = parts[parts.length - 1];
                                    let element = $('#f-r-' + index);
                                    element.empty();
                                }

                                function addSecondPlace(){
                                    let id = document.getElementById('select-second-place').value;
                                    let subject;
                                    for(let i=0; i<subjects.length; i++){
                                        if(subjects[i].id == id){
                                            subject = subjects[i];
                                        }
                                    }
                                    $('#col-second-place').append(
                                        '<div class="row" id="s-r-' + sCount + '">' +
                                        '   <div class="col">' +
                                        '       <div class="input-group py-2">\n' +
                                        '           <span class="input-group-text bg-secondary text-white">Субъект</span>\n' +
                                        '           <input class="form-control" type="text" value="' + subject.title + '" disabled>' +
                                        '           <input name="secondPlace[' + sCount + ']" class="form-control" type="number" value="' + subject.id + '" hidden>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '   <div class="col-1">' +
                                        '       <div class="container d-flex justify-content-center align-items-center" style="height: 100%">' +
                                        '           <button id="f-del-' + sCount + '" type="button" class="btn-close mx-auto text-center border" aria-label="Close" onclick="sDel(this.id)"></button>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '</div>'
                                    );

                                    sCount++;
                                    if(lCount >= 10){
                                        sCount = 0;
                                    }
                                }

                                function sDel(id) {
                                    let parts = id.split('-');
                                    let index = parts[parts.length - 1];
                                    let element = $('#s-r-' + index);
                                    element.empty();
                                }

                                function addLastPlace(){
                                    let id = document.getElementById('select-last-place').value;
                                    let subject;
                                    for(let i=0; i<subjects.length; i++){
                                        if(subjects[i].id == id){
                                            subject = subjects[i];
                                        }
                                    }
                                    $('#col-last-place').append(
                                        '<div class="row" id="l-r-' + lCount + '">' +
                                        '   <div class="col">' +
                                        '       <div class="input-group py-2">\n' +
                                        '           <span class="input-group-text bg-secondary text-white">Субъект</span>\n' +
                                        '           <input class="form-control" type="text" value="' + subject.title + '" disabled>' +
                                        '           <input name="lastPlace[' + lCount + ']" class="form-control" type="number" value="' + subject.id + '" hidden>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '   <div class="col-1">' +
                                        '       <div class="container d-flex justify-content-center align-items-center" style="height: 100%">' +
                                        '           <button id="f-del-' + lCount + '" type="button" class="btn-close mx-auto text-center border" aria-label="Close" onclick="lDel(this.id)"></button>' +
                                        '       </div>' +
                                        '   </div>' +
                                        '</div>'
                                    );

                                    lCount++;
                                    if(lCount >= 10){
                                        lCount = 0;
                                    }
                                }

                                function lDel(id) {
                                    let parts = id.split('-');
                                    let index = parts[parts.length - 1];
                                    let element = $('#l-r-' + index);
                                    element.empty();
                                }
                            </script>
                        </div>
                        <hr>
                    </div>
                    <div class="row">
                        <div class="d-grid py-2">
                            <input class="btn btn-dark" type="submit" value="Сначала заполните карточку соревнования" disabled>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
